test=matrix(c(2,1,1,1),2,2,byrow=T)
test
vector=eigen(test)$vectors
value=eigen(test)$values
vector%*%test%*%solve(vector)
test=matrix(c(2,1,1,2),2,2,byrow=T)
test
vector=eigen(test)$vectors
value=eigen(test)$values
vector%*%test%*%solve(vector)
test=matrix(c(2,1,1,1),2,2,byrow=T)
test
vector=eigen(test)$vectors
value=eigen(test)$values
vector%*%test%*%solve(vector)
t(vector)%*%test%*%solve(t(vector))
test=matrix(c(2,1,1,2),2,2,byrow=T)
test
vector=eigen(test)$vectors
value=eigen(test)$values
vector%*%test%*%solve(vector)
t(vector)%*%test%*%solve(t(vector))
test=matrix(c(2,1,1,2),2,2,byrow=T)
test
vector=eigen(test)$vectors
value=eigen(test)$values
solve(vector)%*%test%*%vector
test=matrix(c(2,1,1,1),2,2,byrow=T)
test
vector=eigen(test)$vectors
value=eigen(test)$values
solve(vector)%*%test%*%vector
t(vector)%*%test%*%solve(t(vector))
test=matrix(c(0.5,-1,-0.25,0.5),2,2,byrow=T)
test
vector=eigen(test)$vectors
value=eigen(test)$values
solve(vector)%*%test%*%vector
t(vector)%*%test%*%solve(t(vector))
test=matrix(c(0.5,-1,-0.25,0.5),2,2,byrow=T)
test
vector=eigen(test)$vectors
value=eigen(test)$values
solve(vector)%*%test%*%vector
vector%*%test%*%s(vector)
vector%*%test%*%slove(vector)
vector%*%test%*%solve(vector)
t(vector)%*%test%*%solve(t(vector))
solve(t(vector)%*%test%*%t(vector)
solve(t(vector)%*%test%*%t(vector)
solve(t(vector))%*%test%*%t(vector)
test=matrix(c(0.5,-1,-0.25,0.5),2,2,byrow=T)
test
vector=eigen(test)$vectors
value=eigen(test)$values
solve(vector)%*%test%*%vector
vector%*%test%*%solve(vector)
solve(t(vector))%*%test%*%t(vector)
t(vector)%*%test%*%solve(t(vector))
setwd("/Users/Fanwing/550400/final")
ibm=read.csv("IBM.csv",head=T)$Close
msft=read.csv("MSFT.csv",head=T)$Close
orcl=read.csv("ORCL.csv",head=T)$Close
adbe=read.csv("ADBE.csv",head=T)$Close
norm(0.3)
mod(0.3)
norm(0.3-i)
dist(0.3-i)
dist(0.3)
nums(0.3)
real(0.3+i)
Mod(0.3+i)
arima111(ibm$Close,google$Close)
arima111(ibm,orcl)
arima111(ibm,orcl)
length(ibm$Close)
arima111(ibm,orcl)
arima111(ibm,orcl)
arima111(msft,orcl)
setwd("/Users/Fanwing/550400/final")
ibm=read.csv("IBM.csv",head=T)$Close
msft=read.csv("MSFT.csv",head=T)$Close
orcl=read.csv("ORCL.csv",head=T)$Close
adbe=read.csv("ADBE.csv",head=T)$Close
arima111=function(data1,data2){
a=rev(log(data1))
b=rev(log(data2))
X1t=diff(diff(a))
X2t=diff(diff(b))
x1t=diff(a)[-1]
x2t=diff(b)[-1]
X1=lm(X1t~x1t+x2t)
X2=lm(X2t~x1t+x2t)
z1=rnorm(length(x1t))
z2=rnorm(length(x2t))
coef=matrix(c(X1$coef,X2$coef),2,3,byrow=T)
phi=coef[,-1]
int=coef[,1]
X1z=X1$residuals+int[1]-z1
X2z=X2$residuals+int[2]-z2
Z1=c(0,z1[-1])
Z2=c(0,z2[-1])
Xz1=lm(X1z~Z1+Z2)
Xz2=lm(X2z~Z1+Z2)
coef2=matrix(c(Xz1$coef,Xz2$coef),2,3,byrow=T)
psi=-coef2[,-1]
eiphi=eigen(phi)$values
eipsi=eigen(psi)$values
ee=Mod(eipsi[1])
evphi=eigen(phi)$vectors
evpsi=eigen(psi)$vectors
return(list(phi=phi,psi=psi,eiphi=eiphi,eipsi=eipsi,z1=summary(z1),z2=summary(z2),ee=ee))
}
arima111(msft,orcl)
Mod(1)
g=c(1.1,0.8,0.9,1.2)
i=g(>1)
t=c(Mod(eiphi[1]),Mod(eiphi[2]),Mod(eipsi[1]),Mod(eipsi[2]))
i=g(>1)
eiphi=eigen(phi)$values
i=sum(g>1)
i
g=c(1.1,0.8,0.9,1)
i=sum(g>1)
i
i=sum(c(1.1,0.8,0.9,1)>1)
i
i=sum(c(1.1,1.8,1.9,1)>1)
i
if (i > 0){}
if (i > 0){k=1}else{k=0}
k
if (i > 0){k=0}else{k=1}
k
test=matrix(c(0.5,-1,-0.25,0.5),2,2,byrow=T)
test
vector=eigen(test)$vectors
value=eigen(test)$values
solve(vector)%*%test%*%vector
setwd("/Users/Fanwing/550400/final")
ibm=read.csv("IBM.csv",head=T)$Close
msft=read.csv("MSFT.csv",head=T)$Close
orcl=read.csv("ORCL.csv",head=T)$Close
adbe=read.csv("ADBE.csv",head=T)$Close
arima111=function(data1,data2){
a=rev(log(data1))
b=rev(log(data2))
X1t=diff(diff(a))
X2t=diff(diff(b))
x1t=diff(a)[-1]
x2t=diff(b)[-1]
X1=lm(X1t~x1t+x2t)
X2=lm(X2t~x1t+x2t)
z1=rnorm(length(x1t))
z2=rnorm(length(x2t))
coef=matrix(c(X1$coef,X2$coef),2,3,byrow=T)
phi2=coef[,-1]
int=coef[,1]
X1z=X1$residuals+int[1]-z1
X2z=X2$residuals+int[2]-z2
Z1=c(0,z1[-1])
Z2=c(0,z2[-1])
Xz1=lm(X1z~Z1+Z2)
Xz2=lm(X2z~Z1+Z2)
coef2=matrix(c(Xz1$coef,Xz2$coef),2,3,byrow=T)
psi2=-coef2[,-1]
eiphi=eigen(phi2)$values
eipsi=eigen(psi2)$values
evphi=eigen(phi2)$vectors
evpsi=eigen(psi2)$vectors
t=sum(c(Mod(eiphi[1]),Mod(eiphi[2]),Mod(eipsi[1]),Mod(eipsi[2]))>1)
if (t > 0){
phi=solve(evphi)%*%phi2%*%evphi
psi=solve(evpsi)%*%psi2%*%evpsi
}
else{
phi=phi2
psi=psi2
}
return(list(phi=phi,psi=psi,eiphi=eiphi,eipsi=eipsi,z1=summary(z1),z2=summary(z2),ee=ee))
}
arima111(msft,orcl)
setwd("/Users/Fanwing/550400/final")
ibm=read.csv("IBM.csv",head=T)$Close
msft=read.csv("MSFT.csv",head=T)$Close
orcl=read.csv("ORCL.csv",head=T)$Close
adbe=read.csv("ADBE.csv",head=T)$Close
arima111=function(data1,data2){
a=rev(log(data1))
b=rev(log(data2))
X1t=diff(diff(a))
X2t=diff(diff(b))
x1t=diff(a)[-1]
x2t=diff(b)[-1]
X1=lm(X1t~x1t+x2t)
X2=lm(X2t~x1t+x2t)
z1=rnorm(length(x1t))
z2=rnorm(length(x2t))
coef=matrix(c(X1$coef,X2$coef),2,3,byrow=T)
phi2=coef[,-1]
int=coef[,1]
X1z=X1$residuals+int[1]-z1
X2z=X2$residuals+int[2]-z2
Z1=c(0,z1[-1])
Z2=c(0,z2[-1])
Xz1=lm(X1z~Z1+Z2)
Xz2=lm(X2z~Z1+Z2)
coef2=matrix(c(Xz1$coef,Xz2$coef),2,3,byrow=T)
psi2=-coef2[,-1]
eiphi=eigen(phi2)$values
eipsi=eigen(psi2)$values
evphi=eigen(phi2)$vectors
evpsi=eigen(psi2)$vectors
t=sum(c(Mod(eiphi[1]),Mod(eiphi[2]),Mod(eipsi[1]),Mod(eipsi[2]))>1)
if (t > 0){
phi=solve(evphi)%*%phi2%*%evphi
psi=solve(evpsi)%*%psi2%*%evpsi
}
else{
phi=phi2
psi=psi2
}
return(list(phi=phi,psi=psi,eiphi=eiphi,eipsi=eipsi,z1=summary(z1),z2=summary(z2)))
}
arima111(msft,orcl)
arima111(msft,orcl)
arima111(ibm,orcl)
arima111(ibm,orcl)
arima111(ibm,adbe)
arima111(orcl,adbe)
arima111(orcl,adbe)
length(ibm$Close)
arima111(orcl,adbe)
arima111(orcl,adbe)
arima111(orcl,adbe)
setwd("/Users/Fanwing/550400/final")
ibm=read.csv("IBM.csv",head=T)$Close
msft=read.csv("MSFT.csv",head=T)$Close
orcl=read.csv("ORCL.csv",head=T)$Close
adbe=read.csv("ADBE.csv",head=T)$Close
sp=read.csv("SP.csv",head=T)$Close
nas=read.csv("NAS.csv",head=T)$Close
arima111=function(data1,data2){
a=rev(log(data1))
b=rev(log(data2))
X1t=diff(diff(a))
X2t=diff(diff(b))
x1t=diff(a)[-1]
x2t=diff(b)[-1]
X1=lm(X1t~x1t+x2t)
X2=lm(X2t~x1t+x2t)
z1=rnorm(length(x1t))
z2=rnorm(length(x2t))
coef=matrix(c(X1$coef,X2$coef),2,3,byrow=T)
phi2=coef[,-1]
int=coef[,1]
X1z=X1$residuals+int[1]-z1
X2z=X2$residuals+int[2]-z2
Z1=c(0,z1[-1])
Z2=c(0,z2[-1])
Xz1=lm(X1z~Z1+Z2)
Xz2=lm(X2z~Z1+Z2)
coef2=matrix(c(Xz1$coef,Xz2$coef),2,3,byrow=T)
psi2=-coef2[,-1]
eiphi=eigen(phi2)$values
eipsi=eigen(psi2)$values
evphi=eigen(phi2)$vectors
evpsi=eigen(psi2)$vectors
t=sum(c(Mod(eiphi[1]),Mod(eiphi[2]),Mod(eipsi[1]),Mod(eipsi[2]))>1)
if (t > 0){
phi=solve(evphi)%*%phi2%*%evphi
psi=solve(evpsi)%*%psi2%*%evpsi
}
else{
phi=phi2
psi=psi2
}
return(list(phi=phi,psi=psi,eiphi=eiphi,eipsi=eipsi,z1=summary(z1),z2=summary(z2)))
}
arima111(sp,nas)
g
gg=g[-1]
gg
ibm=read.csv("IBM.csv",head=T)
ibm
ibm[-1]
ibm=read.csv("IBM.csv",head=T)
ibm[,-1]
ibm=read.csv("IBM.csv",head=T)
ibm[-1,]
ibm=read.csv("IBM.csv",head=T)
ibm
ibm[-1,]
g
diff(g)
arima111=function(data1,data2){
a=rev(log(data1))
b=rev(log(data2))
X1t=diff(a)
X2t=diff(b)
x1t=c(0,diff(a)[-1])
x2t=c(0,diff(b)[-1])
X1=lm(X1t~x1t+x2t)
X2=lm(X2t~x1t+x2t)
z1=rnorm(length(x1t))
z2=rnorm(length(x2t))
coef=matrix(c(X1$coef,X2$coef),2,3,byrow=T)
phi2=coef[,-1]
int=coef[,1]
X1z=X1$residuals+int[1]-z1
X2z=X2$residuals+int[2]-z2
Z1=c(0,z1[-1])
Z2=c(0,z2[-1])
Xz1=lm(X1z~Z1+Z2)
Xz2=lm(X2z~Z1+Z2)
coef2=matrix(c(Xz1$coef,Xz2$coef),2,3,byrow=T)
psi2=-coef2[,-1]
eiphi=eigen(phi2)$values
eipsi=eigen(psi2)$values
evphi=eigen(phi2)$vectors
evpsi=eigen(psi2)$vectors
t=sum(c(Mod(eiphi[1]),Mod(eiphi[2]),Mod(eipsi[1]),Mod(eipsi[2]))>1)
if (t > 0){
phi=solve(evphi)%*%phi2%*%evphi
psi=solve(evpsi)%*%psi2%*%evpsi
}
else{
phi=phi2
psi=psi2
}
return(list(phi=phi,psi=psi,eiphi=eiphi,eipsi=eipsi,z1=summary(z1),z2=summary(z2)))
}
arima111(sp,nas)
g
gg=g[-1]
gg
ggg=c(0,rev(rev(g)[-1]))
ggg
test=matrix(c(-0.5,0,-0.25,-0.5),2,2,byrow=T)
test
value=eigen(test)$values
value
setwd("/Users/Fanwing/550400/final")
ibm=read.csv("IBM.csv",head=T)$Close
msft=read.csv("MSFT.csv",head=T)$Close
orcl=read.csv("ORCL.csv",head=T)$Close
adbe=read.csv("ADBE.csv",head=T)$Close
sp=read.csv("SP.csv",head=T)$Close
nas=read.csv("NAS.csv",head=T)$Close
arima111=function(data1,data2){
a=rev(log(data1))
b=rev(log(data2))
X1t=diff(a)
X2t=diff(b)
x1t=c(0,rev(rev(X1t)[-1]))
x2t=c(0,rev(rev(X2t)[-1]))
X1=lm(X1t~x1t+x2t)
X2=lm(X2t~x1t+x2t)
z1=rnorm(length(x1t))
z2=rnorm(length(x2t))
coef=matrix(c(X1$coef,X2$coef),2,3,byrow=T)
phi2=coef[,-1]
int=coef[,1]
X1z=X1$residuals+int[1]-z1
X2z=X2$residuals+int[2]-z2
Z1=c(0,z1)
Z2=c(0,z2)
Xz1=lm(X1z~Z1+Z2)
Xz2=lm(X2z~Z1+Z2)
coef2=matrix(c(Xz1$coef,Xz2$coef),2,3,byrow=T)
psi2=-coef2[,-1]
eiphi=eigen(phi2)$values
eipsi=eigen(psi2)$values
evphi=eigen(phi2)$vectors
evpsi=eigen(psi2)$vectors
t=sum(c(Mod(eiphi[1]),Mod(eiphi[2]),Mod(eipsi[1]),Mod(eipsi[2]))>1)
if (t > 0){
phi=solve(evphi)%*%phi2%*%evphi
psi=solve(evpsi)%*%psi2%*%evpsi
}
else{
phi=phi2
psi=psi2
}
return(list(phi=phi,psi=psi,eiphi=eiphi,eipsi=eipsi,z1=summary(z1),z2=summary(z2)))
}
arima111(sp,nas)
setwd("/Users/Fanwing/550400/final")
ibm=read.csv("IBM.csv",head=T)$Close
msft=read.csv("MSFT.csv",head=T)$Close
orcl=read.csv("ORCL.csv",head=T)$Close
adbe=read.csv("ADBE.csv",head=T)$Close
sp=read.csv("SP.csv",head=T)$Close
nas=read.csv("NAS.csv",head=T)$Close
arima111=function(data1,data2){
a=rev(log(data1))
b=rev(log(data2))
X1t=diff(a)
X2t=diff(b)
x1t=c(0,rev(rev(X1t)[-1]))
x2t=c(0,rev(rev(X2t)[-1]))
X1=lm(X1t~x1t+x2t)
X2=lm(X2t~x1t+x2t)
z1=rnorm(length(x1t)-1)
z2=rnorm(length(x2t)-1)
coef=matrix(c(X1$coef,X2$coef),2,3,byrow=T)
phi2=coef[,-1]
int=coef[,1]
X1z=X1$residuals+int[1]-z1
X2z=X2$residuals+int[2]-z2
Z1=c(0,z1)
Z2=c(0,z2)
Xz1=lm(X1z~Z1+Z2)
Xz2=lm(X2z~Z1+Z2)
coef2=matrix(c(Xz1$coef,Xz2$coef),2,3,byrow=T)
psi2=-coef2[,-1]
eiphi=eigen(phi2)$values
eipsi=eigen(psi2)$values
evphi=eigen(phi2)$vectors
evpsi=eigen(psi2)$vectors
t=sum(c(Mod(eiphi[1]),Mod(eiphi[2]),Mod(eipsi[1]),Mod(eipsi[2]))>1)
if (t > 0){
phi=solve(evphi)%*%phi2%*%evphi
psi=solve(evpsi)%*%psi2%*%evpsi
}
else{
phi=phi2
psi=psi2
}
return(list(phi=phi,psi=psi,eiphi=eiphi,eipsi=eipsi,z1=summary(z1),z2=summary(z2)))
}
arima111(sp,nas)
setwd("/Users/Fanwing/550400/final")
ibm=read.csv("IBM.csv",head=T)$Close
msft=read.csv("MSFT.csv",head=T)$Close
orcl=read.csv("ORCL.csv",head=T)$Close
adbe=read.csv("ADBE.csv",head=T)$Close
sp=read.csv("SP.csv",head=T)$Close
nas=read.csv("NAS.csv",head=T)$Close
arima111=function(data1,data2){
a=rev(log(data1))
b=rev(log(data2))
X1t=diff(a)
X2t=diff(b)
x1t=c(0,rev(rev(X1t)[-1]))
x2t=c(0,rev(rev(X2t)[-1]))
X1=lm(X1t~x1t+x2t)
X2=lm(X2t~x1t+x2t)
z1=rnorm(length(x1t))
z2=rnorm(length(x2t))
coef=matrix(c(X1$coef,X2$coef),2,3,byrow=T)
phi2=coef[,-1]
int=coef[,1]
X1z=X1$residuals+int[1]-z1
X2z=X2$residuals+int[2]-z2
Z1=c(0,rev(rev(z1)[-1]))
Z2=c(0,rev(rev(z2)[-1]))
Xz1=lm(X1z~Z1+Z2)
Xz2=lm(X2z~Z1+Z2)
coef2=matrix(c(Xz1$coef,Xz2$coef),2,3,byrow=T)
psi2=-coef2[,-1]
eiphi=eigen(phi2)$values
eipsi=eigen(psi2)$values
evphi=eigen(phi2)$vectors
evpsi=eigen(psi2)$vectors
t=sum(c(Mod(eiphi[1]),Mod(eiphi[2]),Mod(eipsi[1]),Mod(eipsi[2]))>1)
if (t > 0){
phi=solve(evphi)%*%phi2%*%evphi
psi=solve(evpsi)%*%psi2%*%evpsi
}
else{
phi=phi2
psi=psi2
}
return(list(phi=phi,psi=psi,eiphi=eiphi,eipsi=eipsi,z1=summary(z1),z2=summary(z2)))
}
arima111(sp,nas)
arima111(ibm,nas)
arima111(ibm,orcl)
arima111(ibm,ibm)
arima111(ibm,msft)
a=c(1,2,3,4,5)
b=c(3,4,5,6,7)
arima111(a,b)
cov(ibm,msft)
cor(ibm,msft)
arima111(ibm,msft)
a=c(1,2,3,4,5)
b=c(7,6,5,4,3)
cor(a,b)
arima111(a,b)
setwd("/Users/Fanwing/550400/rfan410242012.git")
setwd("/Users/Fanwing/550400/rfan410242012.git")
install.packages("filehash")
problem1 <- function(filename = NULL, fcnname = NULL, nrange = NULL, nsample = NULL, compile = NULL) {
require(tikzDevice)
ffilename = paste(filename, ".tex", sep = "")
xbeg = nrange[1]
xend = nrange[2]
xval = seq(xbeg, xend, length = nsample)
yval = fcnname(xval)
tikz(ffilename, standAlone = TRUE)
fcnnamelab = paste("$", deparse(substitute(fcnname)), "$", sep = "")
plot(xval, yval, type = 'l', xlab = "$x$", ylab = fcnnamelab)
dev.off()
if (compile) {
tools::texi2pdf(ffilename)
}
}
problem1('bmw1Series',dnorm,c(-5,5),100,TRUE)
View(problem2)
save.image("~/550400/rfan410242012.git/my1rpack/data/problem2.RData")
